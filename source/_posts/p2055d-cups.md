---
title: 为 HP LaserJet P2055d 打印机 配置CUPS服务器
date: 2025-03-01 22:13:07
tags:
- P2055d
- 打印机
- CUPS
index_img: data:image/jpeg;base64,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
---
# 序
今天翻出了一台吃灰的斐讯N1，准备把它当作打印服务器给**HP LaserJet P2055d**插上翅膀。
# N1刷机
镜像来自于 https://github.com/ophub/amlogic-s9xxx-armbian 。刷机过程中遇到了盒子无法从U盘启动问题，经网友建议，用一根USB公对公数据线连接N1和五福一安充电头辅助供电，N1就顺利从U盘启动了，其余过程不再赘述。
# Armbian配置
## Armbian系统版本
```bash
pico@armbian:~$ cat /etc/os-release 
PRETTY_NAME="Armbian 25.2.2 bullseye"
NAME="Debian GNU/Linux"
VERSION_ID="11"
VERSION="11 (bullseye)"
VERSION_CODENAME=bullseye
ID=debian
HOME_URL="https://www.armbian.com/"
SUPPORT_URL="https://forum.armbian.com"
BUG_REPORT_URL="https://www.armbian.com/bugs"
ARMBIAN_PRETTY_NAME="Armbian 25.2.2 bullseye"
```

## 安装必要软件包和服务

```bash
sudo apt install cups avahi-daemon avahi-discover libnss-mdns hplip foomatic-db foomatic-db-engine printer-driver-all printer-driver-gutenprint printer-driver-brlaser printer-driver-escpr
sudo systemctl enable --now cups
sudo systemctl enable --now avahi-daemon
sudo usermod -aG lpadmin $USER
```

## 禁用IPv6临时地址
打开 `/etc/sysctl.conf`，在最后面加上一行
```bash
net.ipv6.conf.all.use_tempaddr=0
```
然后运行`sudo sysctl -p`使修改生效。我想在外面也能通过IPv6进行打印，所以不希望地址变来变去。

## 折腾CUPS配置文件
这一步可以直接编辑 `/etc/cups/cupsd.conf`，也可以在网页进行。CUPS配置页面地址为 **https://N1的IP地址:631** 。下面仅列出了修改之处：

```bash
# Only listen for connections from the local machine.
Listen 0.0.0.0:631
Listen [::]:631
Listen /run/cups/cups.sock

# Restrict access to the server...
<Location />
  Allow all
  Order allow,deny
</Location>

# Restrict access to the admin pages...
<Location /admin>
  Allow all
  Order allow,deny
</Location>
```
这样设置后，从世界任意地方都能通过IPv6访问我的CUPS服务器，也能发起远程打印。所以不要泄露CUPS服务器的IPv6地址，更不要图省事为它绑定域名。有空时再配置下RouterOS的防火墙，只放行本省内IPv6地址应该就没什么安全问题了。
# 添加配置打印机
在CUPS页面中操作，按照设置向导一步步来就行。在CUPS服务器中，一台打印机可以对应多个打印队列，一个好处便是可以在不同的队列中使用不同的驱动。例如，我为**HP LaserJet P2055d**创建了两个打印队列：

1. P2055d-RAW。驱动为Local Raw Printer，即CUPS服务器直接转发打印数据给打印机，不做任何处理。这个打印队列适合Windows等设备，手动添加打印机并手动安装官方驱动后就可以愉快打印了。
2. P2055d-PCL6。CUPS中使用的驱动为 **HP LaserJet Series PCL 6 CUPS** 。其实P2055d有自己的专属驱动，名为**HP LaserJet p2055d pcl3, hpcups 3.21.2**。只是这个驱动基于PCL3语言过于老旧，所以没有采用。这个打印队列适合给安卓手机等设备使用。
